This is an updated version of the code
